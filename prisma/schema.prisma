generator client {
  provider      = "prisma-client-js"
  // Let Prisma pick native at build time, or pin exactly:
  // binaryTargets = ["debian-openssl-3.0.x"]
  binaryTargets = ["native"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model SorobanEvent {
  id             BigInt     @id @default(autoincrement())
  txHash         String
  contractId     String
  ledger         Int
  topicSignature String
  topics         Json
  data           Json?
  createdAt      DateTime   @default(now())

  @@unique([txHash, contractId, ledger, topicSignature], name: "uq_events_dedupe")
  @@index([ledger], map: "idx_events_ledger")
  @@index([contractId], map: "idx_events_contract")
  @@index([topicSignature], map: "idx_events_signature")
}

model teamFinanceTokens {
  id            BigInt   @id @default(autoincrement())
  blockHeight   Int
  sequence      Int
  address       String
  owner         String
  timestamp     BigInt
  txHash        String
  contractId    String
  
  name          String
  symbol        String
  totalSupply   BigInt
  decimals      Int
  ipfs          String
  createdAt     DateTime @default(now())

  envelopeXdr   String

  @@unique([txHash, address, blockHeight], name: "uq_token_mint_dedupe")
  @@index([address], map: "idx_token_mint_contract")
  @@index([blockHeight], map: "idx_token_mint_ledger")
}
